<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout(~{::title}, ~{::main})}">
<head>
    <title th:text="'Edit Class: ' + ${classDto.name}">Edit Class</title>
    <style>
        /* Optional: Style for the current image preview */
        .current-class-image-preview {
            max-width: 100px; /* Limit preview size */
            max-height: 100px;
            border-radius: 0.375rem; /* rounded-md */
            border: 1px solid #e5e7eb; /* border-gray-200 */
            margin-top: 0.5rem; /* mt-2 */
            object-fit: cover;
        }
        .image-placeholder-icon {
             display: inline-flex;
             align-items: center;
             justify-content: center;
             width: 100px;
             height: 100px;
             background-color: #f3f4f6; /* bg-gray-100 */
             border-radius: 0.375rem;
             border: 1px solid #e5e7eb;
             color: #9ca3af; /* text-gray-400 */
             margin-top: 0.5rem;
        }
         .image-placeholder-icon i {
             font-size: 2rem; /* Adjust icon size */
         }
    </style>
</head>
<body>

    <main th:fragment="main">
         <h2 class="text-2xl font-semibold text-gray-700 mb-6" th:text="'Edit Class: ' + ${classDto.name}">Edit Class</h2>

        <div class="content-card p-6 max-w-lg mx-auto">

             <div th:if="${errorMessage}" class="alert alert-danger mb-4" th:text="${errorMessage}"></div>

             <form th:action="@{/teacher/classes/update/{id}(id=${classId})}"
                   th:object="${classDto}"
                   method="post"
                   enctype="multipart/form-data"
                   class="space-y-4">

                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Class Name</label>
                    <input type="text" id="name" th:field="*{name}" required class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500">
                </div>

                <div>
                    <label for="description" class="block text-sm font-medium text-gray-700 mb-1">Description (Optional)</label>
                     <textarea id="description" th:field="*{description}" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500"></textarea>
                </div>

                <div class="pt-2 border-t border-gray-200 mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Class Image</label>

                    <div>
                        <span class="text-xs text-gray-600">Current Image:</span>
                        <th:block th:if="${existingImagePath != null}">
                            <img th:src="@{/download/class-image/{filename}(filename=${existingImagePath})}"
                                 alt="Current Class Image"
                                 class="current-class-image-preview"
                                 onerror="this.onerror=null; this.style.display='none'; this.nextElementSibling.style.display='inline-flex';">
                             <span class="image-placeholder-icon" style="display: none;"><i class="fas fa-image"></i></span>
                        </th:block>
                        <th:block th:unless="${existingImagePath != null}">
                             <span class="image-placeholder-icon"><i class="fas fa-image"></i></span>
                             <p class="text-xs text-gray-500 italic">No image uploaded.</p>
                        </th:block>
                    </div>

                    <div class="mt-3">
                         <label for="classImageFile" class="block text-sm font-medium text-gray-700 mb-1">Change Image (Optional)</label>
                         <input type="file" id="classImageFile" name="classImageFile" accept="image/png, image/jpeg, image/gif"
                                class="w-full text-sm">
                         <p class="text-xs text-gray-500 mt-1">Select a new image file (PNG, JPG, GIF) to replace the current one. Leave blank to keep the existing image.</p>
                         </div>
                </div>
                <div class="flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 mt-6">
                    <a th:href="@{/teacher/classes}" class="btn btn-secondary btn-sm">Cancel</a>
                    <button type="submit" class="btn btn-primary">Update Class</button>
                </div>
            </form>
        </div>
    </main>

</body>
</html>
